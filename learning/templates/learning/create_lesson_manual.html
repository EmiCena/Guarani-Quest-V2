{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="bento-grid" style="max-width: 800px; margin: 0 auto;">
  <!-- Header Card -->
  <div class="bento-card bento-accent col-span-12">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <h1 style="margin:0;">Crear Lección Manual ✏️</h1>
        <p style="color:var(--muted);margin:8px 0 0;">Crea lecciones personalizadas paso a paso sin usar IA</p>
        <p style="color:#ef4444;font-weight:700;margin:4px 0 0;">⚠️ ACCESO RESTRINGIDO: Solo para administradores</p>
      </div>
      <div class="bento-icon">📝</div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="bento-card col-span-12">
    <h3 style="margin-top:0;">🔧 Acciones Rápidas</h3>
    <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:16px;">
      <a href="{% url 'create_lesson_ai' %}" class="qx-btn qx-outline" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:white;border-color:#8b5cf6;">
        🤖 Crear con IA
      </a>
      <a href="{% url 'admin_panel' %}" class="qx-btn qx-outline">
        📊 Panel Admin
      </a>
      <a href="{% url 'lessons_overview' %}" class="qx-btn qx-outline">
        📚 Ver Lecciones
      </a>
    </div>
  </div>

  {% if success %}
    <!-- Success Message -->
    <div class="bento-card col-span-12">
      <div style="text-align:center;padding:40px;">
        <div style="font-size:48px;margin-bottom:16px;">✅</div>
        <h2 style="color:var(--green);margin-bottom:16px;">¡Lección Creada Exitosamente!</h2>
        <p style="color:var(--muted);margin-bottom:24px;">
          La lección "{{ lesson.title }}" ha sido creada correctamente.
        </p>
        <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;">
          <a href="{% url 'lesson_detail' lesson.id %}" class="qx-btn">Ver Lección</a>
          <a href="{% url 'create_lesson_manual' %}" class="qx-btn qx-outline">Crear Otra Lección</a>
          <a href="{% url 'admin_panel' %}" class="qx-btn qx-outline">Panel Admin</a>
        </div>
      </div>
    </div>

  {% elif error %}
    <!-- Error Message -->
    <div class="bento-card col-span-12">
      <div style="text-align:center;padding:40px;">
        <div style="font-size:48px;margin-bottom:16px;">❌</div>
        <h2 style="color:#ef4444;margin-bottom:16px;">Error</h2>
        <p style="color:var(--muted);margin-bottom:24px;">{{ error }}</p>
        <a href="{% url 'create_lesson_manual' %}" class="qx-btn">Intentar de Nuevo</a>
      </div>
    </div>

  {% else %}
    <!-- Creation Form -->
    <div class="bento-card col-span-12">
      <form method="post" style="padding:0;">
        {% csrf_token %}

        <!-- Lesson Title -->
        <div style="margin-bottom:24px;">
          <label for="title" style="display:block;font-weight:700;margin-bottom:8px;">Título de la Lección *</label>
          <input type="text" id="title" name="title" required
                 style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;"
                 placeholder="Ej: Saludos básicos en guaraní" value="{{ title }}">
        </div>

        <!-- Lesson Description -->
        <div style="margin-bottom:24px;">
          <label for="description" style="display:block;font-weight:700;margin-bottom:8px;">Descripción</label>
          <textarea id="description" name="description" rows="4"
                    style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;resize:vertical;"
                    placeholder="Describe brevemente el contenido de la lección">{{ description }}</textarea>
        </div>

        <!-- Publication Status -->
        <div style="margin-bottom:32px;">
          <label style="display:flex;align-items:center;gap:8px;font-weight:700;cursor:pointer;">
            <input type="checkbox" name="is_published" {% if is_published %}checked{% endif %}
                   style="width:18px;height:18px;cursor:pointer;">
            <span>Publicar inmediatamente</span>
          </label>
          <p style="color:var(--muted);font-size:14px;margin:4px 0 0;">
            Si no marcas esta opción, la lección quedará como borrador y podrás editarla después.
          </p>
        </div>

        <!-- Submit Button -->
        <div style="text-align:center;">
          <button type="submit" class="qx-btn" style="font-size:18px;padding:16px 32px;">
            📝 Crear Lección Manual
          </button>
        </div>
      </form>
    </div>
  {% endif %}

  <!-- Features Info -->
  <div class="bento-card col-span-12">
    <h3 style="margin-top:0;">✨ Características de la Creación Manual</h3>
    <div class="grid grid-2" style="gap:16px;margin-top:16px;">
      <div style="padding:16px;border-radius:12px;background:#f0fdf4;border:1px solid #bbf7d0;">
        <h4 style="margin:0 0 8px;color:var(--green);">🎯 Control Total</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Tú decides exactamente qué contenido incluir en cada sección
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#fef3c7;border:1px solid #fde68a;">
        <h4 style="margin:0 0 8px;color:#d97706;">📋 Estructura Flexible</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Crea lecciones con la estructura que mejor se adapte a tu contenido
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#dbeafe;border:1px solid #93c5fd;">
        <h4 style="margin:0 0 8px;color:#2563eb;">⚡ Proceso Rápido</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Crea lecciones básicas en minutos sin depender de IA
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#f3e8ff;border:1px solid #c084fc;">
        <h4 style="margin:0 0 8px;color:#7c3aed;">🔧 Fácil Edición</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Puedes editar y mejorar la lección después de crearla
        </p>
      </div>
    </div>
  </div>

  <!-- Usage Instructions -->
  <div class="bento-card col-span-12">
    <h3 style="margin-top:0;">📋 Cómo Crear una Lección Manual</h3>
    <div style="display:grid;gap:12px;">
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">1</div>
        <div>
          <strong>Escribe un título claro</strong> que describa el tema de la lección
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">2</div>
        <div>
          <strong>Agrega una descripción</strong> que explique brevemente el contenido
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">3</div>
        <div>
          <strong>Decide si publicar inmediatamente</strong> o guardarla como borrador
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">4</div>
        <div>
          <strong>Haz clic en "Crear Lección Manual"</strong> para guardar la lección básica
        </div>
      </div>
    </div>
    <div style="margin-top:16px;padding:16px;background:#f8fafc;border-radius:8px;border-left:4px solid var(--green);">
      <p style="margin:0;color:var(--muted);font-size:14px;">
        <strong>💡 Consejo:</strong> Después de crear la lección básica, puedes editarla para agregar secciones,
        ejercicios y contenido detallado usando las herramientas de administración.
      </p>
    </div>
  </div>
</div>

<style>
/* Dark theme support */
:root[data-theme="dark"] .bento-card {
  background: var(--card);
  border-color: var(--border);
}

:root[data-theme="dark"] input,
:root[data-theme="dark"] textarea {
  background: var(--surface-2);
  border-color: var(--border);
  color: var(--text);
}

:root[data-theme="dark"] input:focus,
:root[data-theme="dark"] textarea:focus {
  border-color: #22c55e;
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}
</style>
{% endblock %}
