{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="bento-grid" style="max-width: 800px; margin: 0 auto;">
  <!-- Header Card -->
  <div class="bento-card bento-accent col-span-12">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <h1 style="margin:0;">Crear Lecci√≥n con IA ü§ñ</h1>
        <p style="color:var(--muted);margin:8px 0 0;">Genera lecciones autom√°ticamente usando inteligencia artificial</p>
        <p style="color:#ef4444;font-weight:700;margin:4px 0 0;">‚ö†Ô∏è ACCESO RESTRINGIDO: Solo para administradores</p>
      </div>
      <div class="bento-icon">üéì</div>
    </div>
  </div>

  <!-- Main Form Card -->
  <div class="bento-card col-span-12">
    {% if success %}
      <!-- Success Message -->
      <div style="text-align:center;padding:40px;">
        <div style="font-size:48px;margin-bottom:16px;">‚úÖ</div>
        <h2 style="color:var(--green);margin-bottom:16px;">¬°Lecci√≥n Creada Exitosamente!</h2>
        <p style="color:var(--muted);margin-bottom:24px;">
          Se crearon {{ sections_created }} secciones para la lecci√≥n "{{ lesson.title }}"
        </p>
        <div style="display:flex;gap:12px;justify-content:center;">
          <a href="{% url 'lesson_detail' lesson.id %}" class="qx-btn">Ver Lecci√≥n</a>
          <a href="{% url 'create_lesson_ai' %}" class="qx-btn qx-outline">Crear Otra Lecci√≥n</a>
        </div>
      </div>

    {% elif error %}
      <!-- Error Message -->
      <div style="text-align:center;padding:40px;">
        <div style="font-size:48px;margin-bottom:16px;">‚ùå</div>
        <h2 style="color:#ef4444;margin-bottom:16px;">Error</h2>
        <p style="color:var(--muted);margin-bottom:24px;">{{ error }}</p>
        <a href="{% url 'create_lesson_ai' %}" class="qx-btn">Intentar de Nuevo</a>
      </div>

    {% else %}
      <!-- Creation Form -->
      <form method="post" style="padding:0;">
        {% csrf_token %}

        <!-- Lesson Title -->
        <div style="margin-bottom:24px;">
          <label for="title" style="display:block;font-weight:700;margin-bottom:8px;">T√≠tulo de la Lecci√≥n *</label>
          <input type="text" id="title" name="title" required
                 style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;"
                 placeholder="Ej: Saludos b√°sicos en guaran√≠">
        </div>

        <!-- Topic -->
        <div style="margin-bottom:24px;">
          <label for="topic" style="display:block;font-weight:700;margin-bottom:8px;">Tema/T√≥pico *</label>
          <input type="text" id="topic" name="topic" required
                 style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;"
                 placeholder="Ej: saludos, numeros, familia, colores">
        </div>

        <!-- Difficulty Level -->
        <div style="margin-bottom:24px;">
          <label for="difficulty" style="display:block;font-weight:700;margin-bottom:8px;">Nivel de Dificultad</label>
          <select id="difficulty" name="difficulty"
                  style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;">
            <option value="beginner">Principiante</option>
            <option value="intermediate">Intermedio</option>
            <option value="advanced">Avanzado</option>
          </select>
        </div>

        <!-- Number of Sections -->
        <div style="margin-bottom:32px;">
          <label for="sections" style="display:block;font-weight:700;margin-bottom:8px;">N√∫mero de Secciones</label>
          <select id="sections" name="sections"
                  style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:16px;">
            <option value="2">2 secciones</option>
            <option value="3" selected>3 secciones</option>
            <option value="4">4 secciones</option>
            <option value="5">5 secciones</option>
          </select>
        </div>

        <!-- Submit Button -->
        <div style="text-align:center;">
          <button type="submit" class="qx-btn" style="font-size:18px;padding:16px 32px;">
            üöÄ Crear Lecci√≥n con IA
          </button>
        </div>
      </form>
    {% endif %}
  </div>

  <!-- Features Info -->
  <div class="bento-card col-span-12">
    <h3 style="margin-top:0;">‚ú® Caracter√≠sticas de la IA</h3>
    <div class="grid grid-2" style="gap:16px;margin-top:16px;">
      <div style="padding:16px;border-radius:12px;background:#f0fdf4;border:1px solid #bbf7d0;">
        <h4 style="margin:0 0 8px;color:var(--green);">üìù Contenido Autom√°tico</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Genera secciones educativas completas con explicaciones en espa√±ol y frases clave en guaran√≠
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#fef3c7;border:1px solid #fde68a;">
        <h4 style="margin:0 0 8px;color:#d97706;">üéØ Ejercicios Personalizados</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Crea ejercicios de completar espacios, opci√≥n m√∫ltiple y traducci√≥n adaptados al tema
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#dbeafe;border:1px solid #93c5fd;">
        <h4 style="margin:0 0 8px;color:#2563eb;">üß† Aprendizaje Adaptativo</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Usa modelos gratuitos de OpenRouter para contenido de alta calidad
        </p>
      </div>
      <div style="padding:16px;border-radius:12px;background:#f3e8ff;border:1px solid #c084fc;">
        <h4 style="margin:0 0 8px;color:#7c3aed;">‚ö° Generaci√≥n R√°pida</h4>
        <p style="margin:0;color:var(--muted);font-size:14px;">
          Crea lecciones completas en minutos usando inteligencia artificial avanzada
        </p>
      </div>
    </div>
  </div>

  <!-- Usage Instructions -->
  <div class="bento-card col-span-12">
    <h3 style="margin-top:0;">üìã C√≥mo Usar</h3>
    <div style="display:grid;gap:12px;">
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">1</div>
        <div>
          <strong>Elige un t√≠tulo descriptivo</strong> para tu lecci√≥n (ej: "Saludos b√°sicos")
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">2</div>
        <div>
          <strong>Especifica el tema</strong> (saludos, n√∫meros, familia, colores, etc.)
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">3</div>
        <div>
          <strong>Selecciona el nivel de dificultad</strong> y n√∫mero de secciones
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:start;">
        <div style="background:var(--green);color:white;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;">4</div>
        <div>
          <strong>Haz clic en "Crear Lecci√≥n con IA"</strong> y espera a que se genere el contenido
        </div>
      </div>
    </div>
  </div>
</div>

<style>
/* Dark theme support */
:root[data-theme="dark"] .bento-card {
  background: var(--card);
  border-color: var(--border);
}

:root[data-theme="dark"] input,
:root[data-theme="dark"] select {
  background: var(--surface-2);
  border-color: var(--border);
  color: var(--text);
}

:root[data-theme="dark"] input:focus,
:root[data-theme="dark"] select:focus {
  border-color: #22c55e;
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}
</style>
{% endblock %}
